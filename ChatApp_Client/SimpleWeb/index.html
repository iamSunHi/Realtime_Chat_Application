<!DOCTYPE html>
<html>

<head>
    <title>WebSocket Chat</title>
</head>

<body>
    <input type="text" id="messageInput" placeholder="Enter your message" />
    <button onclick="sendMessage()">Send</button>
    <div id="chat"></div>

    <script>
        let USERNAME = "NhatHuy";
        const socket = new WebSocket("wss://localhost:9999/api/chat");

        socket.onopen = (event) => {
            console.log("WebSocket connection established.");
        };

        socket.onmessage = (event) => {
            const receivedMessage = event.data.split(":");
            let message = receivedMessage[1].trim();

            const chatDiv = document.getElementById("chat");
            chatDiv.innerHTML += `<p>${USERNAME}: ${message}</p>`;
        };

        socket.onclose = (event) => {
            if (event.wasClean) {
                console.log(`WebSocket connection closed cleanly, code=${event.code}, reason=${event.reason}`);
            } else {
                console.error(`WebSocket connection died`);
            }
        };

        function sendMessage() {
            const messageInput = document.getElementById("messageInput");
            const message = `${USERNAME}: ${messageInput.value}`;
            socket.send(message);
            messageInput.value = "";
        }
    </script>
</body>

</html>